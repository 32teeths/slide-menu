"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();!function(e){var t="slideMenu",n={position:"right",keycodeOpen:null,keycodeClose:27,showBackLink:!0,submenuLinkBefore:"",submenuLinkAfter:"",backLinkBefore:"",backLinkAfter:""},i=function(){function t(e){_classCallCheck(this,t),this.options=e,this._menu=e.elem,this._menu.find("ul:first").wrap('<div class="slider">'),this._anchors=this._menu.find("a"),this._slider=this._menu.find(".slider:first"),this._level=0,this._isOpen=!1,this._isAnimating=!1,this._hasMenu=this._anchors.length>0,this._setupEventHandlers(),this._setupMenu(),this._hasMenu&&this._setupSubmenus()}return _createClass(t,[{key:"toggle",value:function(){var e=arguments.length<=0||void 0===arguments[0]?null:arguments[0],t=arguments.length<=1||void 0===arguments[1]||arguments[1],n=void 0;return null===e?void(this._isOpen?this.close():this.open()):(e?(n=0,this._isOpen=!0):(n="left"===this.options.position?"-100%":"100%",this._isOpen=!1),void(t?this._triggerAnimation(this._menu,n):(this._pauseAnimations(this._triggerAnimation.bind(this,this._menu,n)),this._isAnimating=!1)))}},{key:"open",value:function(){var e=arguments.length<=0||void 0===arguments[0]||arguments[0];this.toggle(!0,e)}},{key:"close",value:function(){var e=arguments.length<=0||void 0===arguments[0]||arguments[0];this.toggle(!1,e)}},{key:"back",value:function(){this._navigate(null,-1)}},{key:"_setupEventHandlers",value:function(){var t=this;this._hasMenu&&this._anchors.click(function(n){var i=e(n.target).is("a")?e(n.target):e(n.target).parents("a:first");t._navigate(i)}),e(this._menu.add(this._slider)).on("transitionend msTransitionEnd",function(){t._isAnimating=!1}),e(document).keydown(function(e){switch(e.which){case t.options.keycodeClose:t.close();break;case t.options.keycodeOpen:t.open();break;default:return}e.preventDefault()})}},{key:"_navigate",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?1:arguments[1];if(!this._isAnimating){var n=void 0,i=void 0;if(this._level=Number(this._menu.data("level"))||0,n=(this._level+t)*-100,t>0){if(!e.next("ul").length)return;e.next("ul").addClass("active").show()}else{if(0===this._level)return;i="ul "+".active ".repeat(this._level),this._menu.find(i).removeClass("active").fadeOut()}this._menu.data("level",this._level+t),this._triggerAnimation(this._slider,n)}}},{key:"_triggerAnimation",value:function(e,t){String(t).includes("%")||(t+="%"),e.css("transform","translateX("+t+")"),this._isAnimating=!0}},{key:"_setupMenu",value:function(){var e=this;this._pauseAnimations(function(){switch(e.options.position){case"left":e._menu.css({left:0,right:"auto",transform:"translateX(-100%)"});break;default:e._menu.css({left:"auto",right:0})}e._menu.show()})}},{key:"_pauseAnimations",value:function(e){this._menu.addClass("no-transition"),e(),this._menu[0].offsetHeight,this._menu.removeClass("no-transition")}},{key:"_setupSubmenus",value:function(){var t=this;this._anchors.each(function(n,i){if(i=e(i),i.next("ul").length){i.click(function(e){e.preventDefault()});var s=i.text();if(i.html(t.options.submenuLinkBefore+s+t.options.submenuLinkAfter),t.options.showBackLink){var a=e('<a href="#" class="slide-menu-control" data-action="back">'+s+"</a>");a.html(t.options.backLinkBefore+a.text()+t.options.backLinkAfter),i.next("ul").prepend(e("<li>").append(a))}}})}}]),t}();e("body").on("click",".slide-menu-control",function(){var n=void 0,i=e(this).data("target");if(n=i&&"this"!==i?e("#"+i):e(this).parents(".slide-menu:first"),n.length){var s=n.data(t),a=e(this).data("action");s&&"function"==typeof s[a]&&s[a]()}}),e.fn[t]=function(s){if(!e(this).length)return void console.warn("Slide Menu: Unable to find menu DOM element. Maybe a typo?");s=e.extend({},n,s),s.elem=e(this);var a=new i(s);return e(this).data(t,a),a}}(jQuery);